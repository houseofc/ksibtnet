<h1>foo</h1>
<button id="list">List</button>
<br>
<button id="disc">disc</button>


<script>
  var bluetoothDevice;
let serviceUuid = '7d0c1000-e156-4be7-ae55-8b2d90e3af9f';
let characteristicUuid = '7d0c1007-e156-4be7-ae55-8b2d90e3af9f';
var button = document.getElementById('list');

button.addEventListener('pointerup', function(event) {
  navigator.bluetooth.requestDevice({
  filters: [{
    services: [serviceUuid]
  }]
})
.then(device => {
    bluetoothDevice = device;
   // bluetoothDevice.addEventListener('gattserverdisconnected', onDisconnected);
    return bluetoothDevice.gatt.connect()
  })  
.then(server => {
  // Getting SAM Service...
  return server.getPrimaryService(serviceUuid);
})
.then(service => {
  // Getting netinfo  Characteristic...
  return service.getCharacteristic(characteristicUuid);
})
.then(characteristic => {
  // Reading netinfo ...
  return characteristic.readValue();
})
.then(value => {
    var str = new TextDecoder("utf-8").decode(value);
    
  console.log('network info is ' + str+" l: "+str.length);
    var a = JSON.parse(str);
    for (var i=0; i < a.length; i++) {
      var v=a[i];
      console.log(v['iface']);
       console.log(v['ip']);
    }
})
.catch(error => { console.log(error); });        
 })
 
  function onDisconnectButtonClick() {
  if (!bluetoothDevice) {
    return;
  }
  log('Disconnecting from Bluetooth Device...');
  if (bluetoothDevice.gatt.connected) {
    bluetoothDevice.gatt.disconnect();
  } else {
    log('> Bluetooth Device is already disconnected');
  }
}
  var dbutton = document.getElementById('disc');
  dbutton.addEventListener('pointerup', onDisconnectButtonClick());
  
 
</script>
 
